\chapter{Spektrum eines Impulse-Radio UWB-Signals\label{seca}}

Im Folgenden wird aus Gl. (\ref{eq3_30}) auf S. \pageref{eq3_30} das LDS eines
allgemeinen IR-UWB-Signals hergeleitet.
Für stochastische Prozesse berechnet sich das LDS als die
Fouriertransformierte der AKF. Da $s(t)$ jedoch weder stationär noch
schwach stationär ist, ergibt sich für die AKF $\varphi_{ss}(t,\tau)=E\{s(t)
s(t+\tau)\}$ eine Abhängigkeit sowohl von der Zeitdifferenz $\tau$ als
auch vom absoluten Zeitpunkt $t$. Es kann jedoch gezeigt werden, dass $s(t)$
(schwach) zyklostationär \cite{gar94} und $\varphi_{ss}(t,\tau)$ in der
Variable $t$ eine Periode der Länge $T$ besitzt. Man erhält
das mittlere LDS als Fouriertransformierte der über $T$ gemittelten AKF.

Die periodische AKF $\varphi_{ss}(t,\tau)$\label{varphixx} berechnet sich
wie folgt:
%
\begin{align*}
\varphi_{ss}(t,\tau) &= E\{s(t) s(t+\tau)\}\\
&= \sum_{k,\ell=0}^1 \sum_{m,n=-\infty}^\infty
E\{\alpha_{k,n}\; \alpha_{\ell,m}\; p_k(t-nT-\theta_n)\\
& \qquad \qquad \cdot p_\ell(t+\tau-mT-\theta_m)\}.
\end{align*}
%
Da die Datensymbole unabhängig vom TH-Code sind, folgt
%
\begin{align*}
\varphi_{ss}(t,\tau) &= \sum_{k,\ell=0}^1 \sum_{m,n=-\infty}^\infty
E\{\alpha_{k,n}\; \alpha_{\ell,m}\}\\
& \qquad \qquad \cdot E\{p_k(t-nT-\theta_n)\, p_\ell(t+\tau-mT-\theta_m)\}.
\end{align*}
%
Unter der Annahme ideal quellencodierter Daten folgt:
%
\begin{align}
E\{\alpha_{0,n}\} &= E\{\alpha_{1,n}\}=\frac{1}{2}\nonumber\\
E\{\alpha_{0,n} \cdot \alpha_{0,m}\} &= E\{\alpha_{1,n} \cdot \alpha_{1,m}\}=
\begin{cases}
\frac{1}{2} & \fuer \quad n=m\\ 
\frac{1}{4} & \sonst
\end{cases}\nonumber\\
E\{\alpha_{0,n} \cdot \alpha_{1,m}\} &=
\begin{cases}
0 & \fuer \quad n=m\\
\frac{1}{4} & \sonst
\end{cases}\label{eqa_2},
\end{align}
%
wobei $E\{x\}$\label{Ex} den Erwartungswert einer Zufallsvariablen $x$
bezeichnet.

Aus den Glen. (\ref{eqa_2}) ist ersichtlich, dass die vier Fälle
($k$=$\ell$, $m$=$n$), ($k$=$\ell$, $m$$\ne$$n$), ($k$$\ne$$\ell$, $m$=$n$) und
($k$$\ne$$\ell$, $m$$\ne$$n$) unterschieden werden müssen:
%
\begin{align*}
\varphi_{ss}(t,\tau) &= \frac{1}{2} \sum_{\ell=0}^1 \sum_{n=-\infty}^{\infty}
E\{p_\ell(t-nT-\theta_n)\; p_\ell(t+\tau-nT-\theta_n)\}\\
& \quad + \frac{1}{4} \sum_{\ell=0}^1 \sum_{n,m=-\infty \atop n
\neq m}^{\infty} E\{p_\ell(t-nT-\theta_n)\}
E\{p_\ell(t+\tau-mT-\theta_m)\}\\
& \quad + \frac{1}{4} \sum_{n,m=-\infty \atop n
\neq m}^{\infty} E\{p_0(t-nT-\theta_n)\}
\cdot E\{p_1(t+\tau-mT-\theta_m)\}\\
& \quad + \frac{1}{4} \sum_{n,m=-\infty \atop n
\neq m}^{\infty} E\{p_1(t-nT-\theta_n)\}
\cdot E\{p_0(t+\tau-mT-\theta_m)\}\\
&= \varphi_{ss,1}(t,\tau)+\varphi_{ss,2}(t,\tau)-\varphi_{ss,3}(t,\tau)
\end{align*}
%
mit
%
\begin{align*}
\varphi_{ss,1}(t,\tau) &= \frac{1}{2} \sum_{\ell=0}^1
\sum_{n=-\infty}^{\infty}
E\{p_\ell(t-nT-\theta_n)\; p_\ell(t+\tau-nT-\theta_n)\}\\
\varphi_{ss,2}(t,\tau) &= \frac{1}{4} \sum_{\ell,k=0}^1 \left[
\sum_{n=-\infty}^{\infty}
E\{p_\ell(t-nT-\theta_n)\}\right.\\
& \qquad \qquad \cdot \left. \sum_{m=-\infty}^{\infty}
E\{p_k(t+\tau-mT-\theta_m)\} \right]\\
\varphi_{ss,3}(t,\tau) &= \frac{1}{4} \sum_{\ell,k=0}^1
\sum_{n=-\infty}^{\infty}
E\{p_\ell(t-nT-\theta_n)\; E\{p_k(t+\tau-nT-\theta_n)\}.
\end{align*}
%
Da $\theta$ stationär ist, kann im Folgenden auf die Indizes $m$ und $n$
verzichtet werden.
Die Terme $\varphi_{ss,1}(t,\tau)$, $\varphi_{ss,2}(t,\tau)$ und
$\varphi_{ss,3}(t,\tau)$ werden zunächst einzeln berechnet.

\subsubsection{Berechnung des mittleren $\boldsymbol{\varphi_{ss,1}(t,\tau)}$}

Um das mittlere $\varphi_{ss,1}(t,\tau)$ zu erhalten, wird
$\varphi_{ss,1}(t,\tau)$ zunächst fouriertransformiert, im Frequenzbereich
umgeformt und schließlich in den Zeitbereich zurücktransformiert. Im Gegensatz
zur späteren Berechnung des mittleren LDS wird jedoch nicht nach $\tau$, sondern
nach $t$ transformiert. Für $\varphi_{ss,1}(t,\tau)$ folgt:
%
\begin{align*}
\varphi_{ss,1}(t,\tau) &= \frac{1}{2} \sum_{\ell=0}^1 \sum_{n=-\infty}^{\infty}
E\{[p_\ell(t-\theta)\; p_\ell(t+\tau-\theta)]
\ast \delta(t-nT)\}\\
&= \frac{1}{2} \sum_{\ell=0}^1 \sum_{n=-\infty}^{\infty}
\left[ \int\limits_{-\infty}^{\infty} p_\ell(t-\theta)\; p_\ell(t+\tau-\theta)\;
q(\theta)\, d\theta \right] \ast \delta(t-nT),
\end{align*}
%
wobei $q(t)$\label{qt} die Dichte der Zufallsvariablen $\theta$ darstellt.
Mit der Hilfsfunktion $v_\ell(t,\tau)=p_\ell(t)\; p_\ell(t+\tau)$\label{vl}
erhält
man
%
\begin{align*}
\varphi_{ss,1}(t,\tau)
&= \frac{1}{2} \sum_{\ell=0}^1 \sum_{n=-\infty}^{\infty}
v_\ell(t,\tau) \ast q(t) \ast \delta(t-nT)\\
&= \frac{1}{2} \sum_{\ell=0}^1 \mathcal{F}^{-1}
\left\{ V_\ell(f,\tau)\; Q(f)\; \frac{1}{T}
\sum_{n=-\infty}^\infty \delta \left( f-\frac{n}{T} \right) \right\}\\
&= \frac{1}{2T} \sum_{\ell=0}^1 \sum_{n=-\infty}^{\infty}
\mathcal{F}^{-1}\left\{
V_\ell\left(\frac{n}{T},\tau \right)\; Q\left(\frac{n}{T}\right)\;
\delta\left(f-\frac{n}{T}\right)\right\}\\
&= \frac{1}{2T} \sum_{\ell=0}^1 \sum_{n=-\infty}^{\infty}
V_\ell\left(\frac{n}{T},\tau \right)\; Q\left(\frac{n}{T}\right)\; \exp\left(j2\pi
\frac{n}{T} t\right),
\end{align*}
%
wobei $\mathcal{F}^{-1}$\label{mathcalF1} für die inverse Fouriertransformation
steht und Großbuchstaben\label{Pf}\label{Vf}\label{Qf} die Fouriertransformation
der betreffenden Kleinbuchstaben bezeichnen. $Q^*(f)$, welches sowohl als die
konjugiert Komplexe der Fouriertransformation einer Dichte als auch als die
inverse Fouriertransformation einer Dichte interpretiert werden kann,
entspricht der \emph{charakteristischen Funktion} der Verteilung von $\theta$. Da
%
\begin{equation}
\int\limits_0^T \exp\left(j2\pi \frac{n}{T} t\right) =
\begin{cases}
0 \quad \fuer n\in \mathbb{Z} \setminus \{0\}\\
T \quad \fuer n=0
\end{cases}
\label{eqa2}
\end{equation}
%
und für alle charakteristische Funktionen $Q^*(0)=1$ gilt (siehe S.	
\pageref{q}), lässt sich die über eine Periode $T$ gemittelte AKF
$\bar{\varphi}_{ss,1}$\label{barvarphixx}(t) darstellen als
%
\begin{align}
\bar{\varphi}_{ss,1}(\tau)
&= \frac{1}{T}\int\limits_0^T \varphi_{ss,1}(t,\tau)\, dt
= \frac{1}{2T} \sum_{k=0}^1 V_k(0,\tau)\; Q(0) \nonumber\\
&= \frac{1}{2T} \sum_{k=0}^1\; \int\limits_{-\infty}^{\infty} p_k(t)\;
p_k(t+\tau)\, dt\label{eqa_3}.
\end{align}
%

\subsubsection{Berechnung des mittleren $\boldsymbol{\varphi_{ss,2}(t,\tau)}$}

Zur Berechnung von $\varphi_{ss,2}(t,\tau)$ können ähnliche Umformungen im Frequenzbereich wie bei der Berechnung von $\varphi_{ss,1}(t,\tau)$ verwendet werden.
Für $\varphi_{ss,2}(t,\tau)$ folgt:
%
\begin{align*}
\varphi_{ss,2}(t,\tau) &= \frac{1}{4} \sum_{\ell,k=0}^1 \left[
\sum_{n=-\infty}^{\infty}
E\{p_\ell(t-\theta)\} \ast \delta(t-nT) \right.\\
& \qquad \cdot \left. \sum_{m=-\infty}^{\infty} E\{p_k(t+\tau-\theta)\}
\ast \delta(t-mT) \right]\\
&= \frac{1}{4} \sum_{\ell,k=0}^1 \left[
\sum_{n=-\infty}^{\infty}
\int\limits_{-\infty}^{\infty} p_\ell(t-\theta) q(\theta)\, d\theta \ast
\delta(t-nT) \right.\\
& \qquad \left. \cdot \sum_{m=-\infty}^{\infty} \int\limits_{-\infty}^{\infty}
p_k(t+\tau-\theta) q(\theta)\, d\theta \ast \delta(t-mT) \right]\\
&= \frac{1}{4} \sum_{\ell,k=0}^1 \left[ \sum_{n=-\infty}^{\infty} [p_\ell
\ast q](t) \ast \delta(t-nT) \right.\\
& \qquad \cdot \left. \sum_{m=-\infty}^{\infty} [p_k \ast q](t+\tau)
\ast \delta(t-mT) \right]
\end{align*}
%BRUCH
\begin{align*}
\qquad\qquad &= \frac{1}{4T^2} \sum_{\ell,k=0}^1
\mathcal{F}^{-1}\left\{\sum_{n=-\infty}^{\infty} P_\ell(f)\, Q(f)\, \delta
\left(f-\frac{n}{T}\right) \right.\\
& \qquad \ast \left. \sum_{m=-\infty}^{\infty} P_k(f)\, Q(f)\, \delta
\left(f-\frac{m}{T}\right) 
\exp\left( j2\pi \tau f \right)\right\}\\
&= \frac{1}{4T^2} \sum_{\ell,k=0}^1
\mathcal{F}^{-1}\left\{\sum_{n=-\infty}^{\infty} P_\ell\left(\frac{n}{T}\right)
Q\left(\frac{n}{T}\right) \delta \left(f-\frac{n}{T}\right)\right.\\
& \qquad \left. \ast \sum_{m=-\infty}^{\infty} P_k\left(\frac{m}{T}\right)
Q\left(\frac{m}{T}\right) \delta \left(f-\frac{m}{T}\right) \exp\left( j2\pi
\tau \frac{m}{T} \right) \right\}\\
&= \frac{1}{4T^2} \sum_{\ell,k=0}^1
\mathcal{F}^{-1}\left\{\sum_{n,m=-\infty}^{\infty}
P_\ell\left(\frac{n}{T}\right)
Q\left(\frac{n}{T}\right) P_k\left(\frac{m}{T}\right)
Q\left(\frac{m}{T}\right)\right.\\
& \qquad \left. \cdot \exp\left( j2\pi \tau \frac{m}{T} \right) \delta
\left(f-\frac{n+m}{T}\right) \right\}\\
&= \frac{1}{4T^2} \sum_{\ell,k=0}^1 \sum_{n,m=-\infty}^{\infty}
P_\ell\left(\frac{n}{T}\right) Q\left(\frac{n}{T}\right)
P_k\left(\frac{m}{T}\right) Q\left(\frac{m}{T}\right)\\
& \qquad \cdot \exp\left( j2\pi \tau \frac{m}{T} \right) \exp\left( j2\pi
\frac{n+m}{T} t \right).
\end{align*}
%
Mit Gl. (\ref{eqa2}) folgt
%
\begin{multline*}
\bar{\varphi}_{ss,2}(\tau) = \frac{1}{T}\int\limits_0^T \varphi_{ss,2}(t,\tau)\,
dt\\
= \frac{1}{4T^2} \sum_{\ell,k=0}^1 \sum_{n=-\infty}^{\infty}
P_\ell\left(\frac{n}{T}\right) Q\left(\frac{n}{T}\right)
P_k\left(-\frac{n}{T}\right) Q\left(-\frac{n}{T}\right) \exp\left(-j2\pi \tau
\frac{n}{T} \right).\\
\end{multline*}
%
Da $P_k(f)$ und $Q(f)$ die Fouriertransformierten reeller Funktionen
sind, gilt
%
\begin{displaymath}
P_k\left(-f\right)=P_k^*\left(f\right)\quad \mbox{und}\quad
Q\left(-f\right)=Q^*\left(f\right).
\end{displaymath}
%
Für die mittlere AKF folgt somit
%
\begin{equation}
\bar{\varphi}_{ss,2}(\tau) = \frac{1}{4T^2} \sum_{\ell,k=0}^1
\sum_{n=-\infty}^{\infty}
P_\ell\left(\frac{n}{T}\right) P_k^*\left(\frac{n}{T}\right)
\left|Q\left(\frac{n}{T}\right)\right|^2 \exp\left(-j2\pi \tau \frac{n}{T}
\right)\label{eqa_4}.
\end{equation}

\subsubsection{Berechnung des mittleren $\boldsymbol{\varphi_{ss,3}(t,\tau)}$}

$\varphi_{ss,3}(t,\tau)$ kann zunächst nicht signifikant vereinfacht werden:
\begin{align*}
\varphi_{ss,3}(t,\tau) &= \frac{1}{4} \sum_{\ell,k=0}^1
\sum_{n=-\infty}^{\infty}
[E\{p_\ell(t-\theta)\}\, \cdot E\{p_k(t+\tau-\theta)\}] \ast \delta(t-nT)\\
&= \frac{1}{4} \sum_{\ell,k=0}^1 \sum_{n=-\infty}^{\infty} \{ [p_\ell(t)
\ast q(\theta)](t) \cdot
[p_k \ast q](t+\tau)\} \ast \delta(t-nT)\}
\end{align*}
%
Daraus folgt:
%
\begin{align}
\bar{\varphi}_{ss,3}(\tau) &= \frac{1}{T}\int\limits_0^T
\varphi_{ss,3}(t,\tau)\, dt \nonumber\\
&= \frac{1}{4T} \sum_{\ell,k=0}^1 \sum_{n=-\infty}^\infty \int\limits_0^T
[p_\ell \ast q](t-nT)\cdot
[p_k \ast q](t+\tau-nT)\,dt\label{eqa_5}.
\end{align}

\subsubsection{Berechnung des mittleren LDS}

Für die AKF ergibt sich aus den drei Teiltermen (\ref{eqa_3}) bis (\ref{eqa_5})
%
\begin{align*}
\bar{\varphi}_{ss}(\tau) &= \bar{\varphi}_{ss,1}(\tau) +
\bar{\varphi}_{ss,2}(\tau) - \bar{\varphi}_{ss,3}(\tau)
\end{align*}
%BRUCH
\begin{align*}
\qquad & = \frac{1}{2T} \sum_{k=0}^1\; \int\limits_{-\infty}^{\infty}
p_k(t)\; p_k(t+\tau)\, dt\\
& \qquad + \frac{1}{4T^2} \sum_{\ell,k=0}^1 \sum_{n=-\infty}^{\infty}
P_\ell\left(\frac{n}{T}\right) P_k^*\left(\frac{n}{T}\right)
\left|Q\left(\frac{n}{T}\right)\right|^2 \exp\left(-j2\pi \tau \frac{n}{T}
\right)\\
& \qquad - \frac{1}{4T} \sum_{\ell,k=0}^1 \sum_{n=-\infty}^\infty \;
\int\limits_0^T
[p_\ell(t) \ast q(t)](t-nT)\\
&\qquad\qquad \cdot [p_k(t) \ast q(t)](t+\tau-nT)\,
dt.
\end{align*}
%
Das mittlere Leistungsdichtespektrum $\bar{\Phi}_{ss}(f)$ von
$s(t)$ erhält man durch Fouriertransformation von $\bar{\varphi}_{ss}(\tau)$
bzgl. $\tau$:
%
\begin{displaymath}
\bar{\Phi}_{ss}(f)=\mathcal{F}\{\bar{\varphi}_{ss}(\tau)\}=\bar{\Phi}_{ss,1}(f)+
\bar{\Phi}_{ss,2}(f)- \bar{\Phi}_{ss,3}(f).
\end{displaymath}
%
Die LDS der ersten beiden Terme ergeben sich direkt:
%
\begin{align*}
\bar{\Phi}_{ss,1}(f)&=\frac{1}{2T} \sum_{k=0}^1 |P_k(f)|^2\\
\bar{\Phi}_{ss,2}(f)&=\frac{1}{4T^2} \sum_{\ell,k=0}^1
\sum_{n=-\infty}^{\infty}
P_\ell\left(\frac{n}{T}\right) P_k^*\left(\frac{n}{T}\right)
\left|Q\left(\frac{n}{T}\right)\right|^2 \delta\left(f-\frac{n}{T}\right).
\end{align*}
%
$\bar{\Phi}_{ss,3}(f)$ berechnet sich folgendermaßen:
%
\begin{align*}
\bar{\Phi}_{ss,3}(f)&= \frac{1}{4T} \sum_{\ell,k=0}^1 \sum_{n=-\infty}^{\infty}
\int\limits_0^T [p_\ell \ast q](t-nT)\\
& \qquad\qquad \cdot \int\limits_{-\infty}^\infty [p_k \ast
q](t+\tau-nT) \exp(-j2\pi f \tau)\, d\tau\, dt\\
&= \frac{1}{4T} \sum_{\ell,k=0}^1 \sum_{n=-\infty}^{\infty} \int\limits_0^T
[p_\ell \ast q](t-nT)\; P_k(f)\; Q(f)\\
& \qquad\qquad \cdot \exp[j2\pi (t-nT) f]\, dt.
\end{align*}
%
Mit Hilfe der Substitution
%
\begin{displaymath}
u=-t+nT\quad \frac{du}{dt}=-1
\end{displaymath}
%
ergibt sich
%
\begin{align*}
\bar{\Phi}_{ss,3}(f)&= -\frac{1}{4T} \sum_{\ell,k=0}^1 P_k(f)\; Q(f)\\
& \qquad\qquad \cdot \sum_{n=-\infty}^{\infty} \int\limits_{nT}^{nT-T}
[p_\ell \ast q](-u)\;
\exp[-j2\pi u f]\, du\\
&= \frac{1}{4T} \sum_{\ell,k=0}^1 P_k(f)\; Q(f) \int\limits_{-\infty}^{\infty}
[p_\ell \ast q](-u)\; \exp[-j2\pi u f]\, du\\
&= \frac{1}{4T} \sum_{\ell,k=0}^1 P_k(f)\;P_\ell^*(f)\; |Q(f)|^2.
\end{align*}
Für das mittlere LDS eines allgemeinen IR-UWB-Signals folgt schließlich
%
\begin{align*}
\bar{\Phi}_{ss}(f) &= \frac{1}{4T^2} \sum_{\ell,k=0}^1
\sum_{n=-\infty}^{\infty}
P_\ell\left(\frac{n}{T}\right) P_k^*\left(\frac{n}{T}\right)
\left|Q\left(\frac{n}{T}\right)\right|^2 \delta\left(f-\frac{n}{T}\right)\\
& \qquad\qquad + \frac{1}{2T} \sum_{k=0}^1 |P_k(f)|^2
- \frac{1}{4T} \sum_{\ell,k=0}^1 P_k(f)\;P_\ell^*(f)\; |Q(f)|^2.
\end{align*}